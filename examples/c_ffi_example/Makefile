CC = gcc
CFLAGS = -Wall -Wextra -I../../include
# Linking to the static library generated by cargo
LDFLAGS = -L../../target/debug -lflowsdk_ffi -lpthread -ldl

all: mqtt_c_example quic_c_example tls_c_example

mqtt_c_example: main.c
	cargo build -p flowsdk_ffi
	mkdir -p out
	$(CC) $(CFLAGS) main.c -o out/mqtt_c_example $(LDFLAGS)

quic_c_example: quic_main.c
	cargo build -p flowsdk_ffi --features "quic"
	mkdir -p out
	$(CC) $(CFLAGS) quic_main.c -o out/quic_c_example $(LDFLAGS)

tls_c_example:
	cargo build -p flowsdk_ffi --features "tls"
	mkdir -p out
	$(CC) $(CFLAGS) tls_main.c -o out/tls_c_example $(LDFLAGS)

clean:
	rm -rf out
